<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	template="/WEB-INF/templates/template-base.xhtml">
	<ui:define name="content">

		<div>
			<h:form id="create-form">
				<p:messages id="fach_m" />
				<p:panel id="panel" header="Fach hinzufügen"
					style="margin-bottom:10px;">

					<h:outputLabel for="name" value="#{i18n['entity.name']}: " />
					<p:inputText id="name" value="#{fachCtrl.fach.name}"
						pt:placeholder="#{i18n['entity.name']}" />
					<p />
					<p:commandButton value="#{i18n['crud.break']}"
						action="#{fachCtrl.fach}" update="create-form fach_m" />
					<p:commandButton value="#{i18n['crud.create']}"
						icon="ui-icon-check" update="create-form fach_m list-form"
						action="#{fachCtrl.create}" />
				</p:panel>
			</h:form>

			<h:form id="list-form">
				<p:panel id="panel_table_f" header="Liste aller Fächer"
					style="margin-bottom:10px;">

					<p:dataTable id="table-fach" var="_fach"
						rendered="#{not empty faecher}"
						value="#{fachListCtrl.fachDisplays}" tableStyle="width:auto">

						<p:column>
							<f:facet name="header">Id</f:facet>
							<h:outputText value="#{_fach.fach.id}" />
						</p:column>

						<p:column sortBy="#{_fach.fach.name}">
							<f:facet name="header">Name</f:facet>
							<h:outputText value="#{_fach.fach.name}"
								rendered="#{not _fach.editable}" />
							<p:inputText value="#{_fach.fach.name}"
								rendered="#{ _fach.editable}" />
						</p:column>

						<p:column rendered="#{not _fach.editable}">
							<f:facet name="header">Bearbeiten</f:facet>
							<p:commandLink action="#{fachListCtrl.editAction(_fach)}"
								update="table-fach">
								<h:outputText value="#{i18n['crud.edit']}"
									rendered="#{not _fach.editable}" />
							</p:commandLink>
						</p:column>

						<p:column rendered="#{not _fach.editable}">
							<f:facet name="header">Löschen</f:facet>
							<p:commandLink action="#{fachListCtrl.delete(_fach)}"
								value="#{i18n['crud.delete']}" update="table-fach">
								<p:confirm header="Element löschen"
									message="Soll das Fach #{_fach.fach.name} wirklich gelöscht werden?"
									icon="ui-icon-alert" />
							</p:commandLink>
						</p:column>

						<p:column rendered="#{_fach.editable}">

							<p:commandLink action="#{fachListCtrl.update(_fach)}"
								update="table-fach">
								<h:outputText value="#{i18n['crud.save']}" />
							</p:commandLink>
						</p:column>
					</p:dataTable>

					<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
						<p:commandButton value="Yes" type="button"
							styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
							action="#{klassenstufenCtrl.delete}" update="table-fach" />
						<p:commandButton value="No" type="button"
							styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
					</p:confirmDialog>

					<p:panelGrid>
						<p:commandButton value="#{i18n['crud.update']}"
							action="#{fachListCtrl.refreshList}" update="table-fach">
						</p:commandButton>
					</p:panelGrid>
				</p:panel>
			</h:form>

		</div>

	</ui:define>
</ui:composition>