<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	template="/WEB-INF/templates/template-base.xhtml">
	<ui:define name="content">
		<h:form id="form">
			<p:breadCrumb>
				<p:menuitem value="Startseite" url="index.xhtml" />
				<p:menuitem value="Schlüsselkompetenzen"
					url="all_schluesselKomp.xhtml" />
			</p:breadCrumb>
			<p />


			<p />
			<p:dataGrid id="_sks" var="_sk"
				value="#{schluesselKompListCtrl.schluesselDisplays}" columns="4"
				layout="grid" rows="12" paginator="true"
				paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="8,16,36">

				<f:facet name="header">
            		Alle Schlüsselkompetenzen
        		</f:facet>
				<p:panel style="text-align:center">
					<f:facet name="header">
						<h:commandLink id="ajax" update=":new_form:messages"
							actionListener="#{navigationSessionCtrl.setLastSelectedSchluesselKomp(_sk.schluesselKomp)}"
							action="#{schluesselKompListCtrl.goToKompBereich()}">
							<h:outputText value="#{_sk.schluesselKomp.name}" />
						</h:commandLink>
					</f:facet>

					<h:panelGrid columns="3" style="width:100%">

						<p:commandButton
							rendered="#{not empty _sk.schluesselKomp.kommentar}"
							icon="ui-icon-search" update=":form:_skDetail"
							oncomplete="PF('_skDialog').show()" title="Details anzeigen">
							<f:setPropertyActionListener value="#{_sk.schluesselKomp}"
								target="#{schluesselKompCRUDCtrl.schluesselKomp}" />
						</p:commandButton>

						<p:commandButton icon="ui-icon-pencil" update=":form:_sks"
							action="#{schluesselKompListCtrl.goToEdit}" title="Bearbeiten">
							<f:setPropertyActionListener value="#{_sk.schluesselKomp}"
								target="#{schluesselKompCRUDCtrl.schluesselKomp}" />
						</p:commandButton>


						<p:commandButton
							rendered="#{empty _sk.schluesselKomp.kompBereiche}"
							icon="ui-icon-trash" update=":form:_sks"
							action="#{schluesselKompListCtrl.delete(_sk)}"
							title="#{i18n['crud.delete']}">
							<p:confirm header="Element löschen"
								message="Soll die Schlüsselkompetenz #{_sk.schluesselKomp.name} wirklich gelöscht werden?"
								icon="ui-icon-trash" />
						</p:commandButton>

						<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
							<p:commandButton value="No" type="button"
								styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
							<p:commandButton value="Yes" type="button" update=":form:_sks"
								styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
								action="#{schluesselKompListCtrl.deleteWithKB(_sk)}" />
						</p:confirmDialog>

					</h:panelGrid>
				</p:panel>

			</p:dataGrid>



			<p:commandButton value="#{i18n['crud.update']}"
				action="#{schluesselKompListCtrl.refreshList}"
				update=":new_form:messages :form:_sks" type="submit">
			</p:commandButton>

			<p />


			<p:dialog header="Kommentar" widgetVar="_skDialog" modal="true"
				showEffect="fade" hideEffect="fade" resizable="false">
				<p:outputPanel id="_skDetail" style="text-align:center;">
					<h:outputText
						value="#{schluesselKompCRUDCtrl.schluesselKomp.kommentar}" />

				</p:outputPanel>
			</p:dialog>
		</h:form>
		<h:form id="new_form">

			<h1>Neue Schlüsselkompetenz anlegen</h1>
			<p:messages id="messages" showDetail="true" closable="true" />
			<p:panel id="new_sk" title="Neue Schlüsselkompetenz anlegen">

				<h:panelGrid id="panelG" columns="2" cellpadding="5"
					styleClass="ui-grid">
					<h:outputLabel for="name" value="#{i18n['entity.name']}: " />
					<p:inputText id="name"
						value="#{schluesselKompCRUDCtrl.schluesselKomp.name}"
						pt:placeholder="#{i18n['entity.name']}" />

					<h:outputLabel for="kommentar" value="Kommentar:  " />
					<p:inputTextarea id="kommentar" rows="4" cols="42"
						value="#{schluesselKompCRUDCtrl.schluesselKomp.kommentar}"
						pt:placeholder="Kommentar" />
				</h:panelGrid>
				<p:panelGrid id="forautowidth" columns="1">
					<p:dataTable id="chec_kboxDT" rendered="#{not empty kompBereiche}"
						var="_kb" value="#{kompBereichListProducer.kompBereiche}"
						selection="#{schluesselKompCRUDCtrl.selectedKompBereiche}"
						rowKey="#{_kb.id}" tableStyle="width:auto" reflow="true" rows="5"
						paginator="true">
						<f:facet name="header">           Kompetenzbereiche       </f:facet>
						<p:column selectionMode="multiple"
							style="width:16px;text-align:center" />
						<p:column headerText="Name">
							<h:outputText value="#{_kb.name}" />
						</p:column>
						<p:column headerText="Kommentar">
							<h:outputText value="#{_kb.kommentar}" />
						</p:column>
					</p:dataTable>

				</p:panelGrid>
				<p:commandButton value="#{i18n['crud.break']}"
					action="#{schluesselKompCRUDCtrl.clean()}" type="submit"
					update=":new_form:new_sk" />
				<p:commandButton value="#{i18n['crud.create']}"
					action="#{schluesselKompCRUDCtrl.create()}"
					update=":new_form:messages :form:_sks  :new_form:new_sk"
					type="submit" />
			</p:panel>

		</h:form>
	</ui:define>
</ui:composition>